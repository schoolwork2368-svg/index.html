<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webcam Photo Taker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }

        .container {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 100%;
            text-align: center;
        }

        video, canvas {
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            width: 100%;
            height: auto;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s, transform 0.2s;
            cursor: pointer;
            color: white;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .capture-button {
            background-color: #3b82f6;
        }

        .capture-button:hover {
            background-color: #2563eb;
            transform: translateY(-2px);
        }

        .download-button {
            background-color: #10b981;
            display: none; /* Initially hidden */
        }

        .download-button:hover {
            background-color: #059669;
            transform: translateY(-2px);
        }

        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
            z-index: 1000;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 class="text-2xl font-bold mb-4 text-gray-800">Webcam Photo Taker</h1>
    
    <video id="webcam-video" autoplay playsinline></video>
    <canvas id="photo-canvas" style="display:none;"></canvas>

    <div class="controls">
        <button id="capture-btn" class="capture-button">Take Photo</button>
        <a id="download-link" style="text-decoration: none;">
            <button id="download-btn" class="download-button">Download Photo</button>
        </a>
    </div>
</div>

<div id="message-box" class="message-box"></div>

<script>
    const video = document.getElementById('webcam-video');
    const canvas = document.getElementById('photo-canvas');
    const captureBtn = document.getElementById('capture-btn');
    const downloadBtn = document.getElementById('download-btn');
    const downloadLink = document.getElementById('download-link');
    const messageBox = document.getElementById('message-box');
    let stream;

    // Function to show a temporary message
    function showMessage(msg) {
        messageBox.textContent = msg;
        messageBox.style.display = 'block';
        setTimeout(() => {
            messageBox.style.display = 'none';
        }, 3000);
    }

    // Function to start the webcam stream
    async function startWebcam() {
        try {
            // Get user media with video permissions
            stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } });
            video.srcObject = stream;
            video.onloadedmetadata = () => {
                video.play();
            };
        } catch (err) {
            console.error("Error accessing the webcam: ", err);
            showMessage("Error: Could not access webcam. Please ensure you have given permission.");
        }
    }

    // Function to take a photo
    function takePhoto() {
        if (!stream) {
            showMessage("Webcam is not active. Please reload the page and allow webcam access.");
            return;
        }

        // Set canvas dimensions to match the video
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;

        // Draw the video frame onto the canvas
        const context = canvas.getContext('2d');
        context.drawImage(video, 0, 0, canvas.width, canvas.height);

        // Show the download button
        downloadBtn.style.display = 'block';
        
        showMessage("Photo taken successfully!");
    }

    // Function to download the photo
    function downloadPhoto() {
        if (canvas.style.display === 'none') {
            showMessage("No photo has been taken yet.");
            return;
        }
        
        // Get the image data URL from the canvas
        const imageDataURL = canvas.toDataURL('image/png');
        
        // Set the download link's href and filename
        downloadLink.href = imageDataURL;
        downloadLink.download = 'webcam_photo.png';
        
        // This click will trigger the download
        downloadLink.click();
    }

    // Event listeners for buttons
    captureBtn.addEventListener('click', takePhoto);
    downloadBtn.addEventListener('click', downloadPhoto);

    // Start the webcam when the page loads
    window.onload = startWebcam;
</script>

</body>
</html>
